/**
 * Copyright (c) Spectro Cloud
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * Generated by orval v7.10.0 🍺
 * Do not edit manually.
 * Palette APIs - 4.6
 * OpenAPI spec version: v1
 */
import type {
  MetricTimeSeries,
  MetricTimeSeriesList,
  MetricsListParams,
  MetricsUidListParams,
} from ".././schemas";

/**
 * Returns all the metrics for a given resource kind
 * @summary Retrieves the list of metrics for a specified resource kind
 */
export type MetricsListResponse200 = {
  data: MetricTimeSeriesList;
  status: 200;
};

export type MetricsListResponseComposite = MetricsListResponse200;

export type MetricsListResponse = MetricsListResponseComposite & {
  headers: Headers;
};

export const getV1MetricsListUrl = (
  resourceKind: "pod" | "namespace" | "spectrocluster" | "machine" | "project",
  params?: MetricsListParams,
) => {
  const normalizedParams = new URLSearchParams();

  Object.entries(params || {}).forEach(([key, value]) => {
    if (value !== undefined) {
      normalizedParams.append(key, value === null ? "null" : value.toString());
    }
  });

  const stringifiedParams = normalizedParams.toString();

  return stringifiedParams.length > 0
    ? `https://api.spectrocloud.com/v1/metrics/${resourceKind}/values?${stringifiedParams}`
    : `https://api.spectrocloud.com/v1/metrics/${resourceKind}/values`;
};

export const MetricsList = async (
  resourceKind: "pod" | "namespace" | "spectrocluster" | "machine" | "project",
  params?: MetricsListParams,
  options?: RequestInit,
): Promise<MetricsListResponse> => {
  const res = await fetch(getV1MetricsListUrl(resourceKind, params), {
    ...options,
    method: "GET",
  });

  const body = [204, 205, 304].includes(res.status) ? null : await res.text();
  const data: MetricsListResponse["data"] = body ? JSON.parse(body) : {};

  return {
    data,
    status: res.status,
    headers: res.headers,
  } as MetricsListResponse;
};

/**
 * @summary Deletes the metrics of the specified resource
 */
export type MetricsUidDeleteResponse204 = {
  data: void;
  status: 204;
};

export type MetricsUidDeleteResponseComposite = MetricsUidDeleteResponse204;

export type MetricsUidDeleteResponse = MetricsUidDeleteResponseComposite & {
  headers: Headers;
};

export const getV1MetricsUidDeleteUrl = (
  resourceKind: "pod" | "namespace" | "spectrocluster" | "machine" | "project",
  resourceUid: string,
) => {
  return `https://api.spectrocloud.com/v1/metrics/${resourceKind}/${resourceUid}/values`;
};

export const MetricsUidDelete = async (
  resourceKind: "pod" | "namespace" | "spectrocluster" | "machine" | "project",
  resourceUid: string,
  options?: RequestInit,
): Promise<MetricsUidDeleteResponse> => {
  const res = await fetch(getV1MetricsUidDeleteUrl(resourceKind, resourceUid), {
    ...options,
    method: "DELETE",
  });

  const body = [204, 205, 304].includes(res.status) ? null : await res.text();
  const data: MetricsUidDeleteResponse["data"] = body ? JSON.parse(body) : {};

  return {
    data,
    status: res.status,
    headers: res.headers,
  } as MetricsUidDeleteResponse;
};

/**
 * @summary Returns the metrics for a specified resource uid
 */
export type MetricsUidListResponse200 = {
  data: MetricTimeSeries;
  status: 200;
};

export type MetricsUidListResponseComposite = MetricsUidListResponse200;

export type MetricsUidListResponse = MetricsUidListResponseComposite & {
  headers: Headers;
};

export const getV1MetricsUidListUrl = (
  resourceKind: "pod" | "namespace" | "spectrocluster" | "machine" | "project",
  resourceUid: string,
  params?: MetricsUidListParams,
) => {
  const normalizedParams = new URLSearchParams();

  Object.entries(params || {}).forEach(([key, value]) => {
    if (value !== undefined) {
      normalizedParams.append(key, value === null ? "null" : value.toString());
    }
  });

  const stringifiedParams = normalizedParams.toString();

  return stringifiedParams.length > 0
    ? `https://api.spectrocloud.com/v1/metrics/${resourceKind}/${resourceUid}/values?${stringifiedParams}`
    : `https://api.spectrocloud.com/v1/metrics/${resourceKind}/${resourceUid}/values`;
};

export const MetricsUidList = async (
  resourceKind: "pod" | "namespace" | "spectrocluster" | "machine" | "project",
  resourceUid: string,
  params?: MetricsUidListParams,
  options?: RequestInit,
): Promise<MetricsUidListResponse> => {
  const res = await fetch(
    getV1MetricsUidListUrl(resourceKind, resourceUid, params),
    {
      ...options,
      method: "GET",
    },
  );

  const body = [204, 205, 304].includes(res.status) ? null : await res.text();
  const data: MetricsUidListResponse["data"] = body ? JSON.parse(body) : {};

  return {
    data,
    status: res.status,
    headers: res.headers,
  } as MetricsUidListResponse;
};
